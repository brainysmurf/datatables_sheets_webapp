<script>

function returnData() {

	return [];
}

$(function () {
	// Document DOM is ready:

	// Make the tabs
	$('#tabs').tabs();


	google.script.run

      .withSuccessHandler(function (rawData) {
          var template = $.parseHTML(rawData.template || ""),
              $template = $(template),
              columns = rawData.columns.reduce(function (acc, col, ind) {
                acc.push({title: col, data: col});
                return acc;
              }, []) || [];

          // Makes the datatable
          var settings = {
              columns: columns,
          };

          var templateCache = columns.reduce(function (acc, col) {
            acc[col.title] = $template.find('#'+ col.title).html() || "{{self}}";
            return acc;
          }, {});

          var rowsToBeAdded = rawData.rows.reduce(function (acc, row) {
              var valueObj = columns.reduce(function (a, col, index) {
                a[col.title] = row[index];
                return a;
              }, {});
              var result = columns.reduce(function (a, col) {
                var before = templateCache[col.title];
                var combined = Object.assign(valueObj, {self: valueObj[col.title]});
                var after = Handlebars.compile(before)( combined );
                a[col.title] = after;
                return a;
              }, {});
              acc.push(result);
              return acc;
          }, []);

          $DT = $(rawData.selector).DataTable({
          	columns: columns,
          	data: rowsToBeAdded,
          });
       })

      .withFailureHandler(function (error) {
      	  console.log("eeror");
          console.log(error);
      })

	.returnData();  // interact with document with Google API calls


});

</script>